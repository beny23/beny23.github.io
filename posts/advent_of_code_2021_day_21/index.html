<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Advent of code 2021: Day 21 | Tales about Software Engineering</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.73.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet><meta property="og:title" content="Advent of code 2021: Day 21"><meta property="og:description" content="On Day 21 of Advent of Code 2021 we played Dirac Dice! And part one felt way too easy to solve, but I needed have worried because part two we were asked to solve a limited multiverse problem. And without a quantum computer!
The problem The problem was described as follows.
 Two players are playing a game with three dice Each starts on a different position of the board The board is circular and has 10 numbered positions Players take it in turn to roll three dice A player moves forward by the sum of those three dice Once the complete their move, they add as many points to their score as indicated by the board position First to 1000 points wins The dice are deterministic, meaning that they roll 1, 2, 3, &mldr;, 100, 1, 2, &mldr;  Part One To start with, I created some types:"><meta property="og:type" content="article"><meta property="og:url" content="https://beny23.github.io/posts/advent_of_code_2021_day_21/"><meta property="article:published_time" content="2022-01-08T23:44:32+00:00"><meta property="article:modified_time" content="2022-01-08T23:44:32+00:00"><meta itemprop=name content="Advent of code 2021: Day 21"><meta itemprop=description content="On Day 21 of Advent of Code 2021 we played Dirac Dice! And part one felt way too easy to solve, but I needed have worried because part two we were asked to solve a limited multiverse problem. And without a quantum computer!
The problem The problem was described as follows.
 Two players are playing a game with three dice Each starts on a different position of the board The board is circular and has 10 numbered positions Players take it in turn to roll three dice A player moves forward by the sum of those three dice Once the complete their move, they add as many points to their score as indicated by the board position First to 1000 points wins The dice are deterministic, meaning that they roll 1, 2, 3, &mldr;, 100, 1, 2, &mldr;  Part One To start with, I created some types:"><meta itemprop=datePublished content="2022-01-08T23:44:32+00:00"><meta itemprop=dateModified content="2022-01-08T23:44:32+00:00"><meta itemprop=wordCount content="1662"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Advent of code 2021: Day 21"><meta name=twitter:description content="On Day 21 of Advent of Code 2021 we played Dirac Dice! And part one felt way too easy to solve, but I needed have worried because part two we were asked to solve a limited multiverse problem. And without a quantum computer!
The problem The problem was described as follows.
 Two players are playing a game with three dice Each starts on a different position of the board The board is circular and has 10 numbered positions Players take it in turn to roll three dice A player moves forward by the sum of those three dice Once the complete their move, they add as many points to their score as indicated by the board position First to 1000 points wins The dice are deterministic, meaning that they roll 1, 2, 3, &mldr;, 100, 1, 2, &mldr;  Part One To start with, I created some types:"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-171035600-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Tales about Software Engineering</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Blog page">Blog</a></li></ul><a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17h-5.835v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://twitter.com/giskard23 target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://beny23.github.io/posts/advent_of_code_2021_day_21/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://beny23.github.io/posts/advent_of_code_2021_day_21/&text=Advent%20of%20code%202021:%20Day%2021" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://beny23.github.io/posts/advent_of_code_2021_day_21/&title=Advent%20of%20code%202021:%20Day%2021" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Advent of code 2021: Day 21</h1><time class="f6 mv4 dib tracked" datetime=2022-01-08T23:44:32Z>January 8, 2022</time>
<span class="f6 mv4 dib tracked">- 8 minutes read</span>
<span class="f6 mv4 dib tracked">- 1662 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p><img src=/images/advent_of_code_title.jpg alt></p><p>On Day 21 of <a href=https://adventofcode.com/2021>Advent of Code 2021</a> we played Dirac Dice! And part one felt way too
easy to solve, but I needed have worried because part two we were asked to solve a limited multiverse problem.
And without a quantum computer!</p><h1 id=the-problem>The problem</h1><p><a href=https://adventofcode.com/2021/day/21>The problem</a> was described as follows.</p><ul><li>Two players are playing a game with three dice</li><li>Each starts on a different position of the board</li><li>The board is circular and has 10 numbered positions</li><li>Players take it in turn to roll three dice</li><li>A player moves forward by the sum of those three dice</li><li>Once the complete their move, they add as many points to their score as indicated by the board position</li><li>First to 1000 points wins</li><li>The dice are deterministic, meaning that they roll 1, 2, 3, &mldr;, 100, 1, 2, &mldr;</li></ul><h1 id=part-one>Part One</h1><p>To start with, I created some types:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#ff79c6>type</span> <span style=color:#8be9fd>PlayerStatus</span> <span style=color:#ff79c6>=</span> (<span style=color:#8be9fd>Int</span>, <span style=color:#8be9fd>Int</span>)
<span style=color:#ff79c6>type</span> <span style=color:#8be9fd>GameStatus</span> <span style=color:#ff79c6>=</span> (<span style=color:#8be9fd>PlayerStatus</span>, <span style=color:#8be9fd>PlayerStatus</span>)
<span style=color:#ff79c6>type</span> <span style=color:#8be9fd>DiceRolls</span> <span style=color:#ff79c6>=</span> [<span style=color:#8be9fd>Int</span>]
</code></pre></td></tr></table></div></div><ul><li>The player status was a tuple of two integers. The position on the board and the score.</li><li>The game status represented the fact that there are two players.</li><li>The dice rolls were modelled as a list.</li></ul><p>Then my thoughts went to how to model rolling the dice. As Haskell is lazy, I just created the dice rolls as a list:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>diceRolls</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>DiceRolls</span>
<span style=color:#50fa7b>diceRolls</span> <span style=color:#ff79c6>=</span> cycle [<span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>100</span>]
</code></pre></td></tr></table></div></div><p>The <code>cycle</code> function just repeats the list forever. So to roll my dice, I&rsquo;d just have to take some elements off the top
of the list.</p><p>Then I defined a function that would move the player forward by a given number of steps (<code>p</code> is the current position and
<code>n</code> is how many fields forward we move):</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>nextpos</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span>
<span style=color:#50fa7b>nextpos</span> p n <span style=color:#ff79c6>=</span> (p <span style=color:#ff79c6>+</span> n <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>) `mod` <span style=color:#bd93f9>10</span> <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>
</code></pre></td></tr></table></div></div><p>The next step was to model the game itself. I figured I would write a function that would check whether either
player had won, and if not updated the game status. Well, not strictly updating, our data structures are immutable,
but I got so used to thinking recursively that that&rsquo;s what I ended up doing:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>play</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>GameStatus</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>DiceRolls</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span>
<span style=color:#50fa7b>play</span> ((<span style=color:#ff79c6>_</span>, score1), (<span style=color:#ff79c6>_</span>, score2)) num <span style=color:#ff79c6>_</span>
  <span style=color:#ff79c6>|</span> score2 <span style=color:#ff79c6>&gt;=</span> <span style=color:#bd93f9>1000</span> <span style=color:#ff79c6>=</span> score1 <span style=color:#ff79c6>*</span> num
<span style=color:#50fa7b>play</span> ((pos, score), p2) num (r1<span style=color:#8be9fd>:</span>r2<span style=color:#8be9fd>:</span>r3<span style=color:#8be9fd>:</span>dice) <span style=color:#ff79c6>=</span>
  <span style=color:#ff79c6>let</span> pos&#39; <span style=color:#ff79c6>=</span> nextpos pos (r1<span style=color:#ff79c6>+</span>r2<span style=color:#ff79c6>+</span>r3)
      score&#39; <span style=color:#ff79c6>=</span> score <span style=color:#ff79c6>+</span> pos&#39;
  <span style=color:#ff79c6>in</span> play (p2, (pos&#39;, score&#39;)) (num<span style=color:#ff79c6>+</span><span style=color:#bd93f9>3</span>) dice
</code></pre></td></tr></table></div></div><p>There&rsquo;s a few things to unpack:</p><ul><li>The <code>play</code> function takes a game status, the number of dice that have been rolled and the dice roll list</li><li>First, it destructures the status and checks whether player two&rsquo;s score was greater than 1000 already (why only player
two you ask, read on)</li><li>If yes, it returns the answer (AOC was looking for the number of dice rolls times the score of the losing player)</li><li>If no, it would do a turn</li><li>It pulls out the first players status, uses destructuring to get three rolls from the dice list and moves to the
next position</li><li>Then it calls itself recursively swapping player one and two. This way I didn&rsquo;t need any special logic for having the
players take turns.</li><li>N.B. the code doesn&rsquo;t actually tell you who won the game (player 1 and 2 constantly swap) - but the puzzle did not
need that information.</li></ul><p>I was pretty chuffed with this approach!</p><h1 id=part-two>Part Two</h1><p>For part two the rules slightly changed (but make a big difference)</p><ul><li>Instead of dice rolls that go from 1 to 100, deterministically repeating, each dice now only had 3 faces</li><li>But every time the dice gets rolled, the universe would split in 3, with each of the outcomes taking place in
one of the universes</li><li>The games would only last until the winner had reached the score 21</li><li>But the puzzle was to determine how many universes each of the players wins in</li></ul><p>Considering the example stated that</p><blockquote><p>in the example above, player 1 wins in 444356092776315 universes, while player 2 merely wins in
341960390180808 universes</p></blockquote><p>It was immediately clear that brute forcing and simulating each universe separately was not an option</p><p>So I started thinking about the dice rolls. Each player would still make three rolls, add them together and move
forward by that amount. But if a player rolls 1+2+3 or 3+2+1 or 2+2+2, they would move forward 6 positions each.
And I would be able to calculate the next position and update the score once.</p><p>Let&rsquo;s write some code to work out the frequencies of the sums of the dice rolls:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>diceFreq</span> <span style=color:#ff79c6>::</span> [(<span style=color:#8be9fd>Int</span>, <span style=color:#8be9fd>Int</span>)]
<span style=color:#50fa7b>diceFreq</span> <span style=color:#ff79c6>=</span> map (<span style=color:#50fa7b>\</span>x <span style=color:#ff79c6>-&gt;</span> (head x, length x))
             <span style=color:#ff79c6>$</span> group
             <span style=color:#ff79c6>$</span> sort
             <span style=color:#ff79c6>$</span> [a<span style=color:#ff79c6>+</span>b<span style=color:#ff79c6>+</span>c <span style=color:#ff79c6>|</span> a <span style=color:#ff79c6>&lt;-</span> [<span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>3</span>],
                        b <span style=color:#ff79c6>&lt;-</span> [<span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>3</span>],
                        c <span style=color:#ff79c6>&lt;-</span> [<span style=color:#bd93f9>1</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>3</span>]]
</code></pre></td></tr></table></div></div><p>So instead of calculating <code>3^3=27</code> universes, we would look at 7 (and their frequencies)</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#ff79c6>*</span><span style=color:#8be9fd>Part2</span><span style=color:#ff79c6>&gt;</span> diceFreq
[(<span style=color:#bd93f9>3</span>,<span style=color:#bd93f9>1</span>),(<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>3</span>),(<span style=color:#bd93f9>5</span>,<span style=color:#bd93f9>6</span>),(<span style=color:#bd93f9>6</span>,<span style=color:#bd93f9>7</span>),(<span style=color:#bd93f9>7</span>,<span style=color:#bd93f9>6</span>),(<span style=color:#bd93f9>8</span>,<span style=color:#bd93f9>3</span>),(<span style=color:#bd93f9>9</span>,<span style=color:#bd93f9>1</span>)]
</code></pre></td></tr></table></div></div><p>I tried running a simulation then and killed the process after 5 minutes. Clearly, I was still doing too much work.</p><p>As a side note, I think these puzzles are great, because if something takes a long time, you know you&rsquo;re not on the
right path!</p><p>I was thinking I am probably still duplicating a lot of work, so I went about introducing some deduplication:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>dedupe</span> <span style=color:#ff79c6>::</span> [(<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>)] <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>)]
<span style=color:#50fa7b>dedupe</span> <span style=color:#ff79c6>=</span> map (<span style=color:#50fa7b>\</span>gs <span style=color:#ff79c6>-&gt;</span> (fst <span style=color:#ff79c6>$</span> head gs, sum <span style=color:#ff79c6>$</span> map snd gs)) 
       <span style=color:#ff79c6>.</span> groupBy (<span style=color:#50fa7b>\</span>a b <span style=color:#ff79c6>-&gt;</span> (fst a) <span style=color:#ff79c6>==</span> (fst b)) 
       <span style=color:#ff79c6>.</span> sort
</code></pre></td></tr></table></div></div><p>To unpack:</p><ul><li>I&rsquo;ve got a frequency list of game status</li><li>We sort it</li><li>Group it by game status</li><li>And add up all the frequencies</li></ul><p>The next step is to define how we&rsquo;re going to split the universes. First we need a way to check whether a particular
game is finished:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>checkGameover</span> <span style=color:#ff79c6>::</span> (<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Bool</span>
<span style=color:#50fa7b>checkGameover</span> (((<span style=color:#ff79c6>_</span>, score1), (<span style=color:#ff79c6>_</span>, score2)), <span style=color:#ff79c6>_</span>)
  <span style=color:#ff79c6>=</span> max score1 score2 <span style=color:#ff79c6>&gt;=</span> <span style=color:#bd93f9>21</span>
</code></pre></td></tr></table></div></div><p>The above just checks the scores of both players, and if either of them is above 21, the game is finished.</p><p>Then we turn 1 game status into multiple:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>turn</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> (<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>) <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>)]
<span style=color:#50fa7b>turn</span> player x<span style=color:#ff79c6>@</span>(gs, num)
  <span style=color:#ff79c6>|</span> checkGameover x <span style=color:#ff79c6>=</span> [x]
  <span style=color:#ff79c6>|</span> otherwise       <span style=color:#ff79c6>=</span> 
      map (<span style=color:#50fa7b>\</span>(roll, freq) <span style=color:#ff79c6>-&gt;</span> (playerTurn player gs roll, num <span style=color:#ff79c6>*</span> freq)) diceFreq
</code></pre></td></tr></table></div></div><p>To unpack:</p><ul><li>Look at the signature, there&rsquo;s the player (which could be <code>1</code> or <code>2</code>) to indicate which player is taking a turn</li><li>And the game status (with frequency), and it returns a list of game states (with frequency)</li><li>It then uses the <code>diceFreq</code> we&rsquo;ve defined above and uses the <code>playerTurn</code> to play a turn</li><li>The <code>num</code> number of universes is the multiplied with the <code>freq</code> from the dice rolls to determine the new number
of universes that are the same for that particular state</li></ul><p>Looking at <code>playerTurn</code>, that just checks the <code>player</code> parameter to see which player status should be updated. Note,
unlike part one, we now don&rsquo;t want to keep swapping player positions as who wins (player 1 or 2) is pertinent.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>playerTurn</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>GameStatus</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>GameStatus</span>
<span style=color:#50fa7b>playerTurn</span> <span style=color:#bd93f9>1</span> (p1, p2) roll <span style=color:#ff79c6>=</span> (turn&#39; p1 roll, p2)
<span style=color:#50fa7b>playerTurn</span> <span style=color:#bd93f9>2</span> (p1, p2) roll <span style=color:#ff79c6>=</span> (p1, turn&#39; p2 roll)
</code></pre></td></tr></table></div></div><p>The <code>turn'</code> function is pretty similar as before and just determines the next position and score.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>turn&#39;</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>PlayerStatus</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>PlayerStatus</span>
<span style=color:#50fa7b>turn&#39;</span> (pos, score) roll <span style=color:#ff79c6>=</span>
  <span style=color:#ff79c6>let</span> pos&#39; <span style=color:#ff79c6>=</span> nextpos pos roll
      score&#39; <span style=color:#ff79c6>=</span> score <span style=color:#ff79c6>+</span> pos&#39;
  <span style=color:#ff79c6>in</span> (pos&#39;, score&#39;)
</code></pre></td></tr></table></div></div><p>One last helper function will help us to count the results:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>countWinner</span> <span style=color:#ff79c6>::</span> (<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>) <span style=color:#ff79c6>-&gt;</span> [<span style=color:#8be9fd>Int</span>]
<span style=color:#50fa7b>countWinner</span> (((<span style=color:#ff79c6>_</span>, score1), (<span style=color:#ff79c6>_</span>, score2)), num)
  <span style=color:#ff79c6>|</span> score1 <span style=color:#ff79c6>&gt;</span> score2 <span style=color:#ff79c6>=</span> [num, <span style=color:#bd93f9>0</span>]
  <span style=color:#ff79c6>|</span> otherwise       <span style=color:#ff79c6>=</span> [<span style=color:#bd93f9>0</span>, num]
</code></pre></td></tr></table></div></div><p>The above checks the player scores and depending on whether player 1 or 2 is higher, creates a list were the first
or second element contains the number of universes this status represents.</p><p>Putting it all together, we can now define our main function:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>play</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>)] <span style=color:#ff79c6>-&gt;</span> [<span style=color:#8be9fd>Int</span>]
<span style=color:#50fa7b>play</span> player games <span style=color:#ff79c6>=</span>
  <span style=color:#ff79c6>let</span> games&#39; <span style=color:#ff79c6>=</span> games <span style=color:#ff79c6>&gt;&gt;=</span> turn player
      deduped <span style=color:#ff79c6>=</span> dedupe games&#39;
      finished <span style=color:#ff79c6>=</span> all checkGameover deduped
  <span style=color:#ff79c6>in</span> play&#39; player deduped finished

<span style=color:#50fa7b>play&#39;</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>GameStatus</span>, <span style=color:#8be9fd>Int</span>)] <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Bool</span> <span style=color:#ff79c6>-&gt;</span> [<span style=color:#8be9fd>Int</span>]
<span style=color:#50fa7b>play&#39;</span> <span style=color:#ff79c6>_</span> gs <span style=color:#8be9fd>True</span> <span style=color:#ff79c6>=</span> foldl (zipWith (<span style=color:#ff79c6>+</span>)) [<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>$</span> map countWinner gs
<span style=color:#50fa7b>play&#39;</span> player gs <span style=color:#8be9fd>False</span> <span style=color:#ff79c6>=</span> play (nextPlayer player) gs
</code></pre></td></tr></table></div></div><p>To unpack, we:</p><ul><li>Use the bind operator (<code>>>=</code> - think <code>flatMap</code> in scala) to replace each element in the list by using the <code>turn</code>
method to play a turn. This will increase the size of the list</li><li>Then we try to dedupe the list. This will decrease the size of the list.</li><li>Then we check whether all of the games represented by the deduped list are finished.</li><li>If we are finished, then <code>play'</code> will use <code>countWinners</code> and a fold to reduce all the results into a simple list of
universes where player 1 and 2 have won.</li><li>If not finished, then we recursively call <code>play</code> with the next player, to take another turn.</li></ul><p>Rest of the solution on <a href=https://github.com/beny23/advent-of-code/tree/main/2021/haskell/day21>GitHub</a></p><h1 id=conclusion>Conclusion</h1><p>Although I&rsquo;ve got the sneaky suspicion that a lot more in the puzzle could be done with pen, paper and mathematics,
I was quite pleased with the outcome. Using the bind operator (<code>>>=</code>) meant I could keep the number of recursive calls
down to a minimum, and deduplicating kept the lists from growing too big. In the end, part two took about 3 seconds to
run (that&rsquo;s including the build) on my 6 year old MacBook, which I was quite pleased about, though it was interesting
that I&rsquo;m repeated check whether a game has finished yet but that was quicker than maintaining separate lists of
completed games.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://beny23.github.io/>&copy; Software Design Systems 2022</a><div><a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17h-5.835v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://twitter.com/giskard23 target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></footer><script src=/dist/js/app.3fc0f988d21662902933.js></script></body></html>