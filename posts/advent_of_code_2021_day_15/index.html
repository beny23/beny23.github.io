<!doctype html><html lang=en-gb>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Advent of code 2021: Day 15 | Tales about Software Engineering</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet>
<meta property="og:title" content="Advent of code 2021: Day 15">
<meta property="og:description" content="Advent of Code 2021 day 15 took us back to the 2-dimensional maps we first encountered on Day 11 and Day 9. We had to parse a map again, and this time we had to find the shortest path from the top left to the bottom right. This was the first time when a homespun algorithm just did not cut the mustard, and I had to wrack my brain (i.e. use Google) to do a bit of algorithm research.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://beny23.github.io/posts/advent_of_code_2021_day_15/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-19T17:28:32+00:00">
<meta property="article:modified_time" content="2021-12-19T17:28:32+00:00">
<meta itemprop=name content="Advent of code 2021: Day 15">
<meta itemprop=description content="Advent of Code 2021 day 15 took us back to the 2-dimensional maps we first encountered on Day 11 and Day 9. We had to parse a map again, and this time we had to find the shortest path from the top left to the bottom right. This was the first time when a homespun algorithm just did not cut the mustard, and I had to wrack my brain (i.e. use Google) to do a bit of algorithm research."><meta itemprop=datePublished content="2021-12-19T17:28:32+00:00">
<meta itemprop=dateModified content="2021-12-19T17:28:32+00:00">
<meta itemprop=wordCount content="2192">
<meta itemprop=keywords content="functional,haskell,advent-of-code,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Advent of code 2021: Day 15">
<meta name=twitter:description content="Advent of Code 2021 day 15 took us back to the 2-dimensional maps we first encountered on Day 11 and Day 9. We had to parse a map again, and this time we had to find the shortest path from the top left to the bottom right. This was the first time when a homespun algorithm just did not cut the mustard, and I had to wrack my brain (i.e. use Google) to do a bit of algorithm research.">
<link rel=me href=https://infosec.exchange/@beny23>
<script data-goatcounter=https://beny23.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
</head>
<body class="ma0 avenir bg-near-white production">
<header class="cover bg-top" style=background-image:url(https://beny23.github.io/images/advent_of_code_title.jpg)>
<div class="pb3-m pb6-l bg-black-60">
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
Tales about Software Engineering
</a>
<div class="flex-l items-center">
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/about/ title="About page">
About
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/posts/ title="Blog page">
Blog
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/tags/ title="Tags page">
Tags
</a>
</li>
</ul>
<a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://twitter.com/giskard23 target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://infosec.exchange/@beny23 target=_blank class="link-transition mastodon link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=noopener aria-label="follow on Mastodon——Opens in a new window"><svg height="32" style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</nav>
<div class="tc-l pv6 ph3 ph4-ns">
<h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Advent of code 2021: Day 15</h1>
</div>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class=mt3>
<a href="https://www.facebook.com/sharer.php?u=https://beny23.github.io/posts/advent_of_code_2021_day_15/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a href="https://twitter.com/share?url=https://beny23.github.io/posts/advent_of_code_2021_day_15/&text=Advent%20of%20code%202021:%20Day%2015" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://beny23.github.io/posts/advent_of_code_2021_day_15/&title=Advent%20of%20code%202021:%20Day%2015" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">Advent of code 2021: Day 15</h1>
<time class="f6 mv4 dib tracked" datetime=2021-12-19T17:28:32Z>December 19, 2021</time>
<span class="f6 mv4 dib tracked"> - 11 minutes read</span>
<span class="f6 mv4 dib tracked"> - 2192 words</span>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p><a href=https://adventofcode.com/2021>Advent of Code 2021</a> day 15 took us back to the 2-dimensional
maps we first encountered on <a href=https://beny23.github.io/posts/advent_of_code_2021_day_11/>Day 11</a> and
<a href=https://beny23.github.io/posts/advent_of_code_2021_day_9/>Day 9</a>. We had to parse a map again, and this
time we had to find the shortest path from the top left to the bottom right. This was the first
time when a homespun algorithm just did not cut the mustard, and I had to wrack my brain
(i.e. use Google) to do a bit of algorithm research. Though I made sure not to peek at any
haskell implementations. That would&rsquo;ve been cheating.</p>
<h1 id=first-try---epic-fail>First Try - Epic Fail</h1>
<p>So the backstory for this puzzle was in order for the Santa submarine to escape a cave, we had
to navigate a map and find the least risky path. The map would be represented as such:</p>
<pre tabindex=0><code>116
138
213
</code></pre><p>To get from the top left to the bottom right, we would want to traverse the map with the least risk
where risk is the summed value up of every field we pass. The lowest risk of this would be along the
left and bottom edge: 1+1+2+1+3=9.</p>
<p>So I figured how hard can it be and turned the list of strings into a map of (x, y) coordinates mapped
to the risk value. Then add the risk value of this point with the minimum of the neighbours, and just
recursively go through the list (taking care of not visiting points I&rsquo;d visited before).</p>
<p>And then I tried it on the example output. And waited. And waited. That wasn&rsquo;t going to work. I was
not even finished with part one. Thinking about the algorithm because I was going to check the neighbours and the
neighbours were going to check their neighbours, there&rsquo;s going to be a lot of duplicate effort. Exponentially more
effort. And as soon as exponential enters the frame, it&rsquo;s time to rethink!</p>
<h1 id=second-try---somewhat-fail>Second Try - Somewhat Fail</h1>
<p>So I did a bit of research (basically entered &ldquo;Shortest Path&rdquo; and &ldquo;Algorithm&rdquo; into Google) and up popped
good old <a href=https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm>Dijkstra</a>.</p>
<p>The pseudo code for Dijkstra&rsquo;s algorithm is:</p>
<pre tabindex=0><code>Set all distances to Infinity
Except the first point (which is 0)
Start at first point
Loop
  Update the distances of all neighbours
  Find the nearest node not yet visited 
End Loop
</code></pre><p>So that&rsquo;s what I looked at doing:</p>
<p>First, let&rsquo;s define some types:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#ff79c6>type</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>=</span> (<span style=color:#8be9fd>Int</span>, <span style=color:#8be9fd>Int</span>)
<span style=color:#ff79c6>type</span> <span style=color:#8be9fd>RiskMap</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span><span style=color:#8be9fd>Map</span> <span style=color:#8be9fd>Point</span> <span style=color:#8be9fd>Int</span>

<span style=color:#ff79c6>type</span> <span style=color:#8be9fd>PQueue</span> a <span style=color:#ff79c6>=</span> [(a, <span style=color:#8be9fd>Int</span>)]
<span style=color:#ff79c6>type</span> <span style=color:#8be9fd>RiskQueue</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>PQueue</span> <span style=color:#8be9fd>Point</span>

<span style=color:#ff79c6>type</span> <span style=color:#8be9fd>DistMap</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span><span style=color:#8be9fd>Map</span> <span style=color:#8be9fd>Point</span> <span style=color:#8be9fd>Int</span>
</code></pre></td></tr></table>
</div>
</div><p>The idea was that I&rsquo;d make a priority queue which would hold the coordinate and combined distance from the source.
By implementing a priority queue, the item with the lowest distance would always be at the top.</p>
<p>Here was my stab at a priority queue:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>pqPush</span> <span style=color:#ff79c6>::</span> (a, <span style=color:#8be9fd>Int</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>PQueue</span> a <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>PQueue</span> a
<span style=color:#50fa7b>pqPush</span> e <span style=color:#8be9fd>[]</span> <span style=color:#ff79c6>=</span> [e]
<span style=color:#50fa7b>pqPush</span> e<span style=color:#ff79c6>@</span>(<span style=color:#ff79c6>_</span>, pri) qs<span style=color:#ff79c6>@</span>(q<span style=color:#ff79c6>@</span>(<span style=color:#ff79c6>_</span>, pri&#39;) <span style=color:#8be9fd>:</span> qs&#39;) 
  <span style=color:#ff79c6>|</span> pri <span style=color:#ff79c6>&lt;</span> pri&#39; <span style=color:#ff79c6>=</span> e <span style=color:#8be9fd>:</span> qs
  <span style=color:#ff79c6>|</span> otherwise  <span style=color:#ff79c6>=</span> q <span style=color:#8be9fd>:</span> pqPush e qs&#39;
</code></pre></td></tr></table>
</div>
</div><p>The &ldquo;pqPush&rdquo; operation would start at the beginning, and move the the next part of the list until it finds
an item with higher priority. At which point this would insert the record. I find the pattern matching with the
<code>@</code> particularly helpful there. To look at the following in detail:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>pqPush</span> e<span style=color:#ff79c6>@</span>(<span style=color:#ff79c6>_</span>, pri) qs<span style=color:#ff79c6>@</span>(q<span style=color:#ff79c6>@</span>(<span style=color:#ff79c6>_</span>, pri&#39;) <span style=color:#8be9fd>:</span> qs&#39;)
</code></pre></td></tr></table>
</div>
</div><p>That looks a bit of a handful! But essentially it&rsquo;s just two parameters:</p>
<ul>
<li><code>(a, Int)</code> is a tuple of a generic type <code>a</code> and an integer.</li>
<li><code>PQueue a</code> is our priority queue with generic type a. Looking at the type definition of <code>PQueue</code> shows
that this is just <code>[(a, Int)]</code> - a list of the same tuple.</li>
</ul>
<p>So looking at the first parameter, we&rsquo;re destructuring the tuple <code>(a, Int)</code> into <code>e@(_, pri)</code>, which means</p>
<ul>
<li><code>e</code> specifies which contains the whole tuple</li>
<li><code>_</code> means we don&rsquo;t care about the first item in the tuple</li>
<li><code>pri</code> holds the value of the priority.</li>
</ul>
<p>For the second parameter, it gets a little more involved, but that&rsquo;s what makes this destructuring notation so powerful
(I got to know this in Scala and now wince a little every time I use a language where that&rsquo;s not available). So
for <code>qs@(q@(_, pri') : qs')</code> we have</p>
<ul>
<li>a list <code>qs</code> which is the whole parameter</li>
<li>the first element of the list (the head of the list) <code>q</code></li>
<li>the priority <code>pri'</code></li>
<li>and the tail of the list <code>qs'</code></li>
</ul>
<p>Using the destructured parameters, adding the element <code>e</code> to the list in priority order is easy:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell>  <span style=color:#ff79c6>|</span> pri <span style=color:#ff79c6>&lt;</span> pri&#39; <span style=color:#ff79c6>=</span> e <span style=color:#8be9fd>:</span> qs
  <span style=color:#ff79c6>|</span> otherwise  <span style=color:#ff79c6>=</span> q <span style=color:#8be9fd>:</span> pqPush e qs&#39;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>If the priority value <code>pri</code> is less than the priority at the head of the list (<code>pri'</code>), then we insert the element
before the whole list.</li>
<li>Otherwise, we call <code>pqPush</code> recursively with the tail of the list and insert the element that way. This feels
inefficient coming from an imperative programming background, but as no new objects are created for the tail, the
recursive processing of each element is quite performant (especially as Haskell tends to optimise this using tail
recursion automatically)</li>
</ul>
<p>In addition, I implemented <code>pqRemove</code> and <code>pqUpdate</code> to update priority of an item and to remove an item from the head
of the list.</p>
<p>With that priority queue, I was able to implement Djikstra&rsquo;s shortest path algorithm:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>neighbours</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>RiskMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> [<span style=color:#8be9fd>Point</span>]
<span style=color:#50fa7b>neighbours</span> risks (x, y) <span style=color:#ff79c6>=</span> 
  filter (<span style=color:#50fa7b>\</span>p <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span>member p risks) [(x<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, y), (x, y<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>), (x<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>, y), (x, y<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>)]

<span style=color:#50fa7b>distances</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>RiskMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>DistMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> [<span style=color:#8be9fd>Point</span>] <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>Point</span>, <span style=color:#8be9fd>Int</span>)]
<span style=color:#50fa7b>distances</span> risks dists d ns <span style=color:#ff79c6>=</span> 
  map (<span style=color:#50fa7b>\</span>p <span style=color:#ff79c6>-&gt;</span> (p, min (dists <span style=color:#ff79c6>!</span> p) (d <span style=color:#ff79c6>+</span> (risks <span style=color:#ff79c6>!</span> p)))) ns

<span style=color:#50fa7b>step</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>RiskMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>DistMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>RiskQueue</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>DistMap</span>
<span style=color:#50fa7b>step</span> risks dists <span style=color:#8be9fd>[]</span> <span style=color:#ff79c6>=</span> dists
<span style=color:#50fa7b>step</span> risks dists ((p, d)<span style=color:#8be9fd>:</span>qs) <span style=color:#ff79c6>=</span> 
  <span style=color:#ff79c6>let</span> ns <span style=color:#ff79c6>=</span> neighbours risks p
      ds <span style=color:#ff79c6>=</span> distances risks dists d ns
      dists&#39; <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span>union (<span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span>fromList ds) dists
      qs&#39; <span style=color:#ff79c6>=</span> foldl pqUpdate qs ds
      risks&#39; <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span>delete p risks
  <span style=color:#ff79c6>in</span> step risks&#39; dists&#39; qs&#39;
</code></pre></td></tr></table>
</div>
</div><p>Unpacking what&rsquo;s going on there:</p>
<ul>
<li><code>neighbours</code> returns any neighbours of a point <code>(x, y)</code> but it has to be on the risk map. This automatically<br>
ensures that points at the edge of the map are not returned.</li>
<li>the <code>distances</code> function would take a list of points and returns updated distances based on the existing distances
or the distances based on the risk map</li>
<li>both of those return the new distances for the neighbours</li>
<li>that is then used to update the distance map - I used <code>M.union</code>) to merge the new distances with the existing ones
creating <code>dists'</code></li>
<li>then we update the priority list to update the new distances too</li>
<li>then we remove the existing point from the risk map - this prevents them from being visited again</li>
<li>finally, we call <code>step</code> recursively until all elements on the queue are done</li>
</ul>
<p>Once all the points have been calculated, I can just lookup the distance on the final element and I&rsquo;d have my answer for
part one.</p>
<p>So far so good!</p>
<h1 id=third-try---success>Third Try - Success</h1>
<p>For the second part, it turns out that my algorithm would have to be more efficient again. It turns out the size
of our input was not big enough. Really the input was 25 times larger, whereby the original input would be repeated
(and increased) into 5x5 tiles.</p>
<p>As I had already transformed the 2d array into a list of coordinate tuples, making the tiles would just be a matter
of transforming the original list 25 times. First my function for transforming:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>transform</span> <span style=color:#ff79c6>::</span> [(<span style=color:#8be9fd>Point</span>, <span style=color:#8be9fd>Int</span>)] <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>Point</span>, <span style=color:#8be9fd>Int</span>)]
<span style=color:#50fa7b>transform</span> <span style=color:#8be9fd>[]</span> <span style=color:#ff79c6>_</span> <span style=color:#ff79c6>_</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>[]</span>
<span style=color:#50fa7b>transform</span> (((x,y),r)<span style=color:#8be9fd>:</span>ps) p<span style=color:#ff79c6>@</span>(x&#39;,y&#39;) d<span style=color:#ff79c6>@</span>(w, h) 
  <span style=color:#ff79c6>=</span> ((x<span style=color:#ff79c6>+</span>x&#39;<span style=color:#ff79c6>*</span>w,y<span style=color:#ff79c6>+</span>y&#39;<span style=color:#ff79c6>*</span>h), ((r<span style=color:#ff79c6>+</span>x&#39;<span style=color:#ff79c6>+</span>y&#39;<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>) `mod` <span style=color:#bd93f9>9</span>) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>) <span style=color:#8be9fd>:</span> transform ps p d
</code></pre></td></tr></table>
</div>
</div><p>Unpacking this function:</p>
<ul>
<li>It takes a list of points and their associated values</li>
<li>It also takes a transformation point (i.e. where on the 5x5 grid should new point by - from <code>(0, 0)</code> to <code>(4, 4)</code>)</li>
<li>And I pass in the dimensions (<code>d</code>), the width (<code>w</code>) and height (<code>h</code>) of the original grid.</li>
<li>To &ldquo;move&rdquo;, the position is adjusted as follows <code>(x+x'*w, y+y'*h)</code></li>
<li>and the risk value as such <code>((r+x'+y'-1) ``mod`` 9) + 1</code> - this ensures that the value is increased but rolls over
if it passes 9 as per requirements.</li>
</ul>
<p>Then I can use that to transform the whole input:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>makeTransforms</span> <span style=color:#ff79c6>=</span> [(x,y) <span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>&lt;-</span> [<span style=color:#bd93f9>0</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>4</span>], y <span style=color:#ff79c6>&lt;-</span> [<span style=color:#bd93f9>0</span><span style=color:#ff79c6>..</span><span style=color:#bd93f9>4</span>]]

<span style=color:#50fa7b>makeGrid</span> <span style=color:#ff79c6>::</span> [(<span style=color:#8be9fd>Point</span>, <span style=color:#8be9fd>Int</span>)] <span style=color:#ff79c6>-&gt;</span> [(<span style=color:#8be9fd>Point</span>, <span style=color:#8be9fd>Int</span>)]
<span style=color:#50fa7b>makeGrid</span> points <span style=color:#ff79c6>=</span> 
  <span style=color:#ff79c6>let</span> dim <span style=color:#ff79c6>=</span> maximum <span style=color:#ff79c6>$</span> map fst <span style=color:#ff79c6>$</span> points
      ts <span style=color:#ff79c6>=</span> makeTransforms
  <span style=color:#ff79c6>in</span> concat <span style=color:#ff79c6>$</span> map (<span style=color:#50fa7b>\</span>t <span style=color:#ff79c6>-&gt;</span> transform points t dim) ts
</code></pre></td></tr></table>
</div>
</div><p>The <code>makeTransforms</code> just creates a list like so:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell>[(<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>0</span>),(<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>1</span>),(<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>2</span>),(<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>3</span>),(<span style=color:#bd93f9>0</span>,<span style=color:#bd93f9>4</span>),(<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>0</span>),(<span style=color:#bd93f9>1</span>,<span style=color:#bd93f9>1</span>),<span style=color:#ff79c6>...</span>,(<span style=color:#bd93f9>4</span>,<span style=color:#bd93f9>4</span>)] 
</code></pre></td></tr></table>
</div>
</div><p>The original list is then transformed 25 times (the transform at <code>(0, 0)</code> does not change the original list), and the
resulting list of lists is then turned into a single list containing all the points.</p>
<p>As it turns out the list is a bit big. And my previous algorithm takes a long long time to run (I interrupted it
after 10 minutes, so I don&rsquo;t actually know how long!)</p>
<p>But I figured as I was using an algorithm that should be known to every Computer Science degree, it was unlikely that
the problem was with the algorithm, probably my implementation was a bit shoddy.</p>
<p>My first thought of where the problem could be was here:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>pqUpdate</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Eq</span> a <span style=color:#ff79c6>=&gt;</span> <span style=color:#8be9fd>PQueue</span> a <span style=color:#ff79c6>-&gt;</span> (a, <span style=color:#8be9fd>Int</span>) <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>PQueue</span> a
<span style=color:#50fa7b>pqUpdate</span> qs q<span style=color:#ff79c6>@</span>(e, pri) <span style=color:#ff79c6>=</span> pqPush q <span style=color:#ff79c6>$</span> pqRemove e qs
</code></pre></td></tr></table>
</div>
</div><p>In order to update all the items in my priority queue, I&rsquo;d traverse it to remove the item, only then to traverse it
again to push the item back in with the new priority. Considering that I would do this for every neighbour on ever
point I&rsquo;m processing I put it down as something to fix.</p>
<p>Here&rsquo;s what I changed:</p>
<ul>
<li>Instead of initialising my priority queue with all the elements, so I&rsquo;d have to update items again and again, I&rsquo;d
just start with the items being processed. That way it keeps the list small. I&rsquo;d also use a set to keep track
of the points already visited.</li>
</ul>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>step</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>RiskMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>DistMap</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>VisitedSet</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>RiskQueue</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>DistMap</span>
<span style=color:#50fa7b>step</span> dim risks dists visited <span style=color:#8be9fd>[]</span> <span style=color:#ff79c6>=</span> dists
<span style=color:#50fa7b>step</span> dim risks dists visited ((p, d)<span style=color:#8be9fd>:</span>qs) <span style=color:#ff79c6>=</span> 
  <span style=color:#ff79c6>let</span> ns <span style=color:#ff79c6>=</span> neighbours visited dim p
      ds <span style=color:#ff79c6>=</span> distances risks dists d ns
      dists&#39; <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span>union (<span style=color:#8be9fd>M</span><span style=color:#ff79c6>.</span>fromList ds) dists
      qs&#39; <span style=color:#ff79c6>=</span> foldl (<span style=color:#50fa7b>\</span>qs q <span style=color:#ff79c6>-&gt;</span> pqPush q qs) qs ds
      visited&#39; <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>S</span><span style=color:#ff79c6>.</span>insert p visited
  <span style=color:#ff79c6>in</span> step dim risks dists&#39; visited&#39; qs&#39;
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Instead of relying on the risk map to check whether a point is on or off the grid, I&rsquo;d pass the dimensions to
the <code>neighbours</code> function and use that to filter off-grid coordinates.</li>
</ul>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>neighbours</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>VisitedSet</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> [<span style=color:#8be9fd>Point</span>]
<span style=color:#50fa7b>neighbours</span> visited d (x, y) <span style=color:#ff79c6>=</span> filter (<span style=color:#50fa7b>\</span>p <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>S</span><span style=color:#ff79c6>.</span>notMember p visited) <span style=color:#ff79c6>$</span> filter (onBoard d) [(x<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>, y), (x, y<span style=color:#ff79c6>-</span><span style=color:#bd93f9>1</span>), (x<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>, y), (x, y<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>)]

<span style=color:#50fa7b>onBoard</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Point</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Bool</span>
<span style=color:#50fa7b>onBoard</span> (w, h) (x, y)
  <span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>1</span>     <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>False</span>
  <span style=color:#ff79c6>|</span> y <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>1</span>     <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>False</span>
  <span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>&gt;</span> w     <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>False</span>
  <span style=color:#ff79c6>|</span> y <span style=color:#ff79c6>&gt;</span> h     <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>False</span>
  <span style=color:#ff79c6>|</span> otherwise <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>True</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Instead of updating any point regardless of whether it had changed, I&rsquo;d only update points where the distance had
changed</li>
</ul>
<pre tabindex=0><code>distances :: RiskMap -&gt; DistMap -&gt; Int -&gt; [Point] -&gt; [(Point, Int)]
distances risks dists d ns = ns &gt;&gt;= (distance risks dists d)

distance :: RiskMap -&gt; DistMap -&gt; Int -&gt; Point -&gt; [(Point, Int)]
distance risks dists d p = distance' p (dists ! p) (d + (risks ! p))

distance' :: Point -&gt; Int -&gt; Int -&gt; [(Point, Int)]
distance' p d d' 
  | d' &lt; d    = [(p, d')]
  | otherwise = []
</code></pre><p>What I did there was to use the bind operator <code>>>=</code> to change the list, so that if the distance does not change,
<code>distance'</code> returns an empty list, which means the item currently being processed is removed from the list. This
is the behaviour of the monadic bind. Previously I&rsquo;ve grown to really like it as the <code>flatMap</code> function in Scala.</p>
<p>Once all those change were in, my algorithm ran on the extended size part two input in about 90 seconds. At that point
I stopped trying to make further optimisations. If I had, I might have looked into binary heaps or tree data structures
for the priority map.</p>
<p>Rest of the solution on <a href=https://github.com/beny23/advent-of-code/tree/main/2021/haskell/day15>GitHub</a></p>
<h1 id=conclusion>Conclusion</h1>
<p>I loved this puzzle, as it meant having to reach further into the algorithm toolbox and pure intuition was not
good enough. I found it really interesting optimising the second part to ensure that my algorithm implementation
was as good as the algorithm itself&mldr;</p>
<b>Tags</b>
<a href=https://beny23.github.io/tags/functional/>functional</a> <a href=https://beny23.github.io/tags/haskell/>haskell</a> <a href=https://beny23.github.io/tags/advent-of-code/>advent-of-code</a>
<p>
If you'd like to find more of my writing, why not follow me on
<a href=https://twitter.com/giskard23 title="Twitter link" rel=noopener aria-label="follow on Twitter - Opens in a new window">Twitter</a> or
<a href=https://infosec.exchange/@beny23 title="Mastodon link" rel=noopener aria-label="follow on Mastodon - Opens in a new window">Mastodon</a>?
</p>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Related</p>
<ul class="pa0 list">
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_14/>Advent of code 2021: Day 14</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_13/>Advent of code 2021: Day 13</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_12/>Advent of code 2021: Day 12</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_11/>Advent of code 2021: Day 11</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_10/>Advent of code 2021: Day 10</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_9/>Advent of code 2021: Day 9</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_8/>Advent of code 2021: Day 8</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_7/>Advent of code 2021: Day 7</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_6/>Advent of code 2021: Day 6</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_5/>Advent of code 2021: Day 5</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_4/>Advent of code 2021: Day 4</a>
</li>
<li class=mb2>
<a href=/posts/fizzbuzz_without_ifs/>Fizzbuzz without if clauses</a>
</li>
</ul>
</div>
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://beny23.github.io/>
&copy; Software Design Systems 2024
</a>
<div>
<a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://twitter.com/giskard23 target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://infosec.exchange/@beny23 target=_blank class="link-transition mastodon link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=noopener aria-label="follow on Mastodon——Opens in a new window"><svg height="32" style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</footer>
<script src=/dist/js/app.3fc0f988d21662902933.js></script>
</body>
</html>