<!doctype html><html lang=en-gb>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Advent of code 2021: Day 18 | Tales about Software Engineering</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet>
<meta property="og:title" content="Advent of code 2021: Day 18">
<meta property="og:description" content="Day 18 of Advent of Code 2021 took rather a long time to get right. Half of the problem was that there were a couple of gotchas in the requirements and the choice of data structure hugely impacted how easy it was to come up with a solution. Just like Day 17 I was using TDD and this helped me root out some blind alleys nicely.
The problem The story was roughly as follows: In order to continue on the Advent of Code submarine journey, we had to solve snailfish number problems.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://beny23.github.io/posts/advent_of_code_2021_day_18/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-29T02:14:32+00:00">
<meta property="article:modified_time" content="2021-12-29T02:14:32+00:00">
<meta itemprop=name content="Advent of code 2021: Day 18">
<meta itemprop=description content="Day 18 of Advent of Code 2021 took rather a long time to get right. Half of the problem was that there were a couple of gotchas in the requirements and the choice of data structure hugely impacted how easy it was to come up with a solution. Just like Day 17 I was using TDD and this helped me root out some blind alleys nicely.
The problem The story was roughly as follows: In order to continue on the Advent of Code submarine journey, we had to solve snailfish number problems."><meta itemprop=datePublished content="2021-12-29T02:14:32+00:00">
<meta itemprop=dateModified content="2021-12-29T02:14:32+00:00">
<meta itemprop=wordCount content="1921">
<meta itemprop=keywords content="functional,haskell,advent-of-code,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Advent of code 2021: Day 18">
<meta name=twitter:description content="Day 18 of Advent of Code 2021 took rather a long time to get right. Half of the problem was that there were a couple of gotchas in the requirements and the choice of data structure hugely impacted how easy it was to come up with a solution. Just like Day 17 I was using TDD and this helped me root out some blind alleys nicely.
The problem The story was roughly as follows: In order to continue on the Advent of Code submarine journey, we had to solve snailfish number problems.">
<link rel=me href=https://infosec.exchange/@beny23>
<script data-goatcounter=https://beny23.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
</head>
<body class="ma0 avenir bg-near-white production">
<header class="cover bg-top" style=background-image:url(https://beny23.github.io/images/advent_of_code_title.jpg)>
<div class="pb3-m pb6-l bg-black-60">
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
Tales about Software Engineering
</a>
<div class="flex-l items-center">
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/about/ title="About page">
About
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/posts/ title="Blog page">
Blog
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/talks/ title="Talks page">
Talks
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/tags/ title="Tags page">
Tags
</a>
</li>
</ul>
<a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://twitter.com/giskard23 target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://infosec.exchange/@beny23 target=_blank class="link-transition mastodon link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=noopener aria-label="follow on Mastodon——Opens in a new window"><svg height="32" style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</nav>
<div class="tc-l pv6 ph3 ph4-ns">
<h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Advent of code 2021: Day 18</h1>
</div>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class=mt3>
<a href="https://www.facebook.com/sharer.php?u=https://beny23.github.io/posts/advent_of_code_2021_day_18/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a href="https://twitter.com/share?url=https://beny23.github.io/posts/advent_of_code_2021_day_18/&text=Advent%20of%20code%202021:%20Day%2018" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://beny23.github.io/posts/advent_of_code_2021_day_18/&title=Advent%20of%20code%202021:%20Day%2018" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">Advent of code 2021: Day 18</h1>
<time class="f6 mv4 dib tracked" datetime=2021-12-29T02:14:32Z>December 29, 2021</time>
<span class="f6 mv4 dib tracked"> - 10 minutes read</span>
<span class="f6 mv4 dib tracked"> - 1921 words</span>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Day 18 of <a href=https://adventofcode.com/2021>Advent of Code 2021</a> took rather a long time to get right. Half of
the problem was that there were a couple of gotchas in the requirements and the choice of data structure hugely
impacted how easy it was to come up with a solution. Just like <a href=https://beny23.github.io/posts/advent_of_code_2021_day_17/>Day 17</a>
I was using TDD and this helped me root out some blind alleys nicely.</p>
<h1 id=the-problem>The problem</h1>
<p><a href=https://adventofcode.com/2021/day/18>The story</a> was roughly as follows: In order to continue on the Advent of Code
submarine journey, we had to solve snailfish number problems. The issue with snailfish numbers is that they&rsquo;re unlike
other numbers, and are built using number pairs:</p>
<pre tabindex=0><code>[1,2]
[[1,2],3]
[9,[8,7]]
[[1,9],[8,5]]
</code></pre><p>Pairs can have pairs nested inside them. To add snailfish numbers, the following rules had to be followed:</p>
<ul>
<li>If any single number is greater than or equal to 10, it is replaced by a pair of numbers. This is called a <em>split</em>.</li>
<li>If any pair is nested more than 4 levels deep, then the pair is added to neighbouring numbers and replaced with a
single <code>0</code>. This is called <em>exploding</em>.</li>
</ul>
<h1 id=first-thoughts>First thoughts</h1>
<p>My initial thought was that having pairs and nested pairs sounds exactly like a tree. So I started building a parser
to read in the numbers and build a tree structure.</p>
<p>First, the data type:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#ff79c6>data</span> <span style=color:#8be9fd>Elem</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>Lit</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>|</span> <span style=color:#8be9fd>Pair</span> <span style=color:#8be9fd>Elem</span> <span style=color:#8be9fd>Elem</span> <span style=color:#ff79c6>deriving</span> (<span style=color:#8be9fd>Eq</span>, <span style=color:#8be9fd>Show</span>)
</code></pre></td></tr></table>
</div>
</div><p>So an element is either a <code>Lit</code> literal with an integer value or a <code>Pair</code> of elements. Building on my experience
with parsing on <a href=https://beny23.github.io/posts/advent_of_code_2021_day_16/>Day 16</a>, turning the raw strings into a tree felt easy:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>p_lit</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Parsec</span> <span style=color:#8be9fd>String</span> <span style=color:#8be9fd;font-style:italic>()</span> <span style=color:#8be9fd>Elem</span>
<span style=color:#50fa7b>p_lit</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>do</span>
  num <span style=color:#ff79c6>&lt;-</span> read <span style=color:#ff79c6>&lt;$&gt;</span> many1 digit
  return (<span style=color:#8be9fd>Lit</span> num)

<span style=color:#50fa7b>p_elem</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Parsec</span> <span style=color:#8be9fd>String</span> <span style=color:#8be9fd;font-style:italic>()</span> <span style=color:#8be9fd>Elem</span>
<span style=color:#50fa7b>p_elem</span> <span style=color:#ff79c6>=</span> p_pair <span style=color:#ff79c6>&lt;|&gt;</span> p_lit

<span style=color:#50fa7b>p_pair</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Parsec</span> <span style=color:#8be9fd>String</span> <span style=color:#8be9fd;font-style:italic>()</span> <span style=color:#8be9fd>Elem</span>
<span style=color:#50fa7b>p_pair</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>do</span>
  char <span style=color:#f1fa8c>&#39;[&#39;</span>
  e1 <span style=color:#ff79c6>&lt;-</span> p_elem
  char <span style=color:#f1fa8c>&#39;,&#39;</span>
  e2 <span style=color:#ff79c6>&lt;-</span> p_elem
  char <span style=color:#f1fa8c>&#39;]&#39;</span>
  return (<span style=color:#8be9fd>Pair</span> e1 e2)
</code></pre></td></tr></table>
</div>
</div><p>This would give me a tree as this test demonstrates:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>it</span> <span style=color:#f1fa8c>&#34;parses a nested pair&#34;</span> <span style=color:#ff79c6>$</span> <span style=color:#ff79c6>do</span>
  parse p_pair <span style=color:#f1fa8c>&#34;&#34;</span> <span style=color:#f1fa8c>&#34;[1,[2,3]]&#34;</span> 
    `shouldBe` <span style=color:#8be9fd>Right</span> (<span style=color:#8be9fd>Pair</span> (<span style=color:#8be9fd>Lit</span> <span style=color:#bd93f9>1</span>) (<span style=color:#8be9fd>Pair</span> (<span style=color:#8be9fd>Lit</span> <span style=color:#bd93f9>2</span>) (<span style=color:#8be9fd>Lit</span> <span style=color:#bd93f9>3</span>)))
</code></pre></td></tr></table>
</div>
</div><p>My next step was going to be to implement the split and explode functions. And that&rsquo;s where I hit my first issue.
Split was going to be straightforward enough, I would traverse my tree and just replace any <code>Lit</code> that has a value
greater than or equal to 10 and replace it with a pair. But on the exploding function, it wouldn&rsquo;t be so
straightforward. In order to explode, we had to:</p>
<ul>
<li>Replace the pair with a <code>Lit 0</code></li>
<li>Add the left element of the pair to the first occurring <code>Lit</code> that is to the right in the tree (can be on the
same or a different level)</li>
<li>Same with the right element, that gets pushed right.</li>
</ul>
<p>The tree structure wasn&rsquo;t going to work for me there. In an imperative language where we&rsquo;d have references to different
objects, it would have been possible to go backwards and forwards in the tree and mutate the values in-place. But
in Haskell this wouldn&rsquo;t be so simple as the tree is immutable.</p>
<p>Eventually - after attempting some solutions with keeping state and pushing values left and right, I had a solution
that was not very elegant and frankly smelled a bit. I was prepared to let that go to get my answers in, but as it
turned out my unit tests uncovered that the exploding wasn&rsquo;t working like the examples.</p>
<h1 id=back-to-the-drawing-board>Back to the drawing board</h1>
<p>Eventually I figured that the tree was not the right data structure. In order to push the exploding numbers left and
right, something like a list felt more natural. Eventually - after a lot of trying different approaches - I settled on
a data structure where I&rsquo;d use the &ldquo;path&rdquo; from the root of the tree down to the leaf.</p>
<p>So if I had a (crudely drawn) tree as such</p>
<pre tabindex=0><code>      Pair
    /      \
  Lit 1   Pair
         /   \
      Lit 2  Lit 3 
</code></pre><p>Then for each <code>Pair</code>, I would record whether I take the left or right branch by a 0 or 1. So the above tree
would be represented by a list</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell>[(<span style=color:#f1fa8c>&#34;0&#34;</span>, <span style=color:#bd93f9>1</span>), (<span style=color:#f1fa8c>&#34;10&#34;</span>, <span style=color:#bd93f9>2</span>), (<span style=color:#f1fa8c>&#34;11&#34;</span>, <span style=color:#bd93f9>3</span>)]
</code></pre></td></tr></table>
</div>
</div><p>I&rsquo;m only listing the leaves of the tree, not the internal nodes. To convert from my tree to this list, I used
the following</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>tree2list</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>String</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Elem</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span>
<span style=color:#50fa7b>tree2list</span> path (<span style=color:#8be9fd>Lit</span> x) <span style=color:#ff79c6>=</span> [(path, x)]
<span style=color:#50fa7b>tree2list</span> path (<span style=color:#8be9fd>Pair</span> l r) <span style=color:#ff79c6>=</span> 
  (tree2list (path <span style=color:#ff79c6>++</span> <span style=color:#f1fa8c>&#34;0&#34;</span>) l) <span style=color:#ff79c6>++</span> 
  (tree2list (path <span style=color:#ff79c6>++</span> <span style=color:#f1fa8c>&#34;1&#34;</span>) r)
</code></pre></td></tr></table>
</div>
</div><p>Now I had my data structure right, the split operation was quite straightforward:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>split</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span>
<span style=color:#50fa7b>split</span> <span style=color:#8be9fd>[]</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>[]</span>
<span style=color:#50fa7b>split</span> (e<span style=color:#ff79c6>@</span>(p,x)<span style=color:#8be9fd>:</span>es)
  <span style=color:#ff79c6>|</span> x <span style=color:#ff79c6>&gt;=</span> <span style=color:#bd93f9>10</span>   <span style=color:#ff79c6>=</span> (p <span style=color:#ff79c6>++</span> <span style=color:#f1fa8c>&#34;0&#34;</span>, x `div` <span style=color:#bd93f9>2</span>) <span style=color:#8be9fd>:</span> 
                (p <span style=color:#ff79c6>++</span> <span style=color:#f1fa8c>&#34;1&#34;</span>, (x<span style=color:#ff79c6>+</span><span style=color:#bd93f9>1</span>) `div` <span style=color:#bd93f9>2</span>) <span style=color:#8be9fd>:</span> es
  <span style=color:#ff79c6>|</span> otherwise <span style=color:#ff79c6>=</span> e <span style=color:#8be9fd>:</span> split es
</code></pre></td></tr></table>
</div>
</div><p>This operation recursively goes through each of the elements in the list until it finds the first node where
the value is greater or equal 10. If that&rsquo;s the case, it replaces that single element by a pair (by adding 0 and 1
to the &ldquo;path&rdquo;).</p>
<p>The explode function was a little more complicated, first I built a helper to check whether two paths are for
elements that would explode:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>isExplodingPair</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>String</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>String</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Bool</span>
<span style=color:#50fa7b>isExplodingPair</span> p1 p2
  <span style=color:#ff79c6>|</span> length p1 <span style=color:#ff79c6>/=</span> length p2 <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>False</span>
  <span style=color:#ff79c6>|</span> length p1 <span style=color:#ff79c6>&lt;</span> <span style=color:#bd93f9>5</span>          <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>False</span>
  <span style=color:#ff79c6>|</span> otherwise              <span style=color:#ff79c6>=</span> (stem p1) <span style=color:#ff79c6>==</span> (stem p2)

<span style=color:#50fa7b>stem</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>String</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>String</span>
<span style=color:#50fa7b>stem</span> p <span style=color:#ff79c6>=</span> take ((length p) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>) p
</code></pre></td></tr></table>
</div>
</div><p>That can then be plugged into:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>explode</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span>
<span style=color:#50fa7b>explode</span> es <span style=color:#ff79c6>=</span> explode&#39; <span style=color:#8be9fd>[]</span> es

<span style=color:#50fa7b>explode&#39;</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span>
<span style=color:#50fa7b>explode&#39;</span> es&#39; [e&#39;] <span style=color:#ff79c6>=</span> reverse <span style=color:#ff79c6>$</span> e&#39;<span style=color:#8be9fd>:</span>es&#39;
<span style=color:#50fa7b>explode&#39;</span> es&#39; (e&#39;<span style=color:#ff79c6>@</span>(p1, x1) <span style=color:#8be9fd>:</span> e<span style=color:#ff79c6>@</span>(p2, x2) <span style=color:#8be9fd>:</span> es)
  <span style=color:#ff79c6>|</span> isExplodingPair p1 p2 <span style=color:#ff79c6>=</span> 
       (reverse <span style=color:#ff79c6>$</span> addToFirst x1 <span style=color:#ff79c6>$</span> es&#39;) <span style=color:#ff79c6>++</span> 
       [(stem p1, <span style=color:#bd93f9>0</span>)] <span style=color:#ff79c6>++</span> 
       (addToFirst x2 es)
  <span style=color:#ff79c6>|</span> otherwise <span style=color:#ff79c6>=</span> 
       explode&#39; (e&#39;<span style=color:#8be9fd>:</span>es&#39;) (e<span style=color:#8be9fd>:</span>es)

<span style=color:#50fa7b>addToFirst</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Int</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span>
<span style=color:#50fa7b>addToFirst</span> <span style=color:#ff79c6>_</span> <span style=color:#8be9fd>[]</span> <span style=color:#ff79c6>=</span> <span style=color:#8be9fd>[]</span>
<span style=color:#50fa7b>addToFirst</span> x&#39; ((p, x)<span style=color:#8be9fd>:</span>es) <span style=color:#ff79c6>=</span> (p, x<span style=color:#ff79c6>+</span>x&#39;)<span style=color:#8be9fd>:</span>es
</code></pre></td></tr></table>
</div>
</div><p>The main logic is in the <code>explode'</code> function. It works as follows:</p>
<ul>
<li>It has two parameters: a list of elements that have already been visited and a list that are still to be visited.</li>
<li>It then recursively goes through the list, picking out the first two elements.</li>
<li>If those two elements are to explode, it uses the <code>addToFirst</code> helper to add the left element of the pair (<code>x1</code>) to
the last element that was visited (as it is more efficient to add to lists at the front than append at the back,
I am reversing the list of already visited nodes)</li>
<li>The right element (<code>x2</code>) is added to the first element of the list of not yet processed nodes</li>
<li>The two elements are replaced by a single value.</li>
</ul>
<p>Initially, when I was writing this I was playing with a &ldquo;findExplodingPair&rdquo; function that would get me the position
of the first exploding pair, then I was going to have a second pass to add the left value to the first element whose
path was smaller than the found path, and a third pass&mldr; I didn&rsquo;t like it, so I was quite pleased when I managed to
turn that into a single block.</p>
<h1 id=one-more-gotcha>One more gotcha</h1>
<p>I had implemented the above and still my tests were not passing. Eventually, I figured out that I needed to read the
instructions again:</p>
<blockquote>
<p>To reduce a snailfish number, you must repeatedly do the first action in this list that applies to the snailfish number:</p>
<ul>
<li>If any pair is nested inside four pairs, the leftmost such pair explodes.</li>
<li>If any regular number is 10 or greater, the leftmost such regular number splits.</li>
</ul>
</blockquote>
<p>My initial reading of this was to implement:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>repeatUntil</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Eq</span> a <span style=color:#ff79c6>=&gt;</span> (a <span style=color:#ff79c6>-&gt;</span> a) <span style=color:#ff79c6>-&gt;</span> a <span style=color:#ff79c6>-&gt;</span> a
<span style=color:#50fa7b>repeatUntil</span> f e <span style=color:#ff79c6>=</span> repeatUntil&#39; f e <span style=color:#ff79c6>$</span> f e

<span style=color:#50fa7b>repeatUntil&#39;</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Eq</span> a <span style=color:#ff79c6>=&gt;</span> (a <span style=color:#ff79c6>-&gt;</span> a) <span style=color:#ff79c6>-&gt;</span> a <span style=color:#ff79c6>-&gt;</span> a <span style=color:#ff79c6>-&gt;</span> a
<span style=color:#50fa7b>repeatUntil&#39;</span> f e1 e2
  <span style=color:#ff79c6>|</span> e1 <span style=color:#ff79c6>==</span> e2  <span style=color:#ff79c6>=</span> e1
  <span style=color:#ff79c6>|</span> otherwise <span style=color:#ff79c6>=</span> repeatUntil f e2

<span style=color:#50fa7b>reduce</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span>
<span style=color:#50fa7b>reduce</span> el <span style=color:#ff79c6>=</span> repeatUntil (repeatUntil split <span style=color:#ff79c6>.</span> repeatUntil explode) el
</code></pre></td></tr></table>
</div>
</div><p>The <code>repeatUntil</code> helper takes two things of the same type and a function. If the two inputs are the same, then
we&rsquo;re finished and return it. If they are not the same, it would call the function and then itself. In Java
this would be a while loop. I did like the function composition there that allowed me to call <code>explode</code> until
the input didn&rsquo;t change anymore and then <code>split</code>.</p>
<p>That&rsquo;s where I had a subtle bug though. I was calling <code>split</code> until I couldn&rsquo;t split anymore. That resulted in
failing tests. When I changed it to</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>reduce</span> el <span style=color:#ff79c6>=</span> repeatUntil (split <span style=color:#ff79c6>.</span> repeatUntil explode) el
</code></pre></td></tr></table>
</div>
</div><p>it started working!</p>
<h1 id=magnitude>Magnitude</h1>
<p>Finally, to be able to enter the solution into the AOC website, we had to calculate the magnitude of a snailfish number.
The magnitude was defined as</p>
<blockquote>
<p>The magnitude of a pair is 3 times the magnitude of its left element plus 2 times the magnitude of its
right element. The magnitude of a regular number is just that number.</p>
</blockquote>
<p>Now this would be easy if we were using our tree structure:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>magnitude</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>Elem</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Int</span>
<span style=color:#50fa7b>magnitude</span> (<span style=color:#8be9fd>Lit</span> x) <span style=color:#ff79c6>=</span> x
<span style=color:#50fa7b>magnitude</span> (<span style=color:#8be9fd>Pair</span> l r) <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>3</span> <span style=color:#ff79c6>*</span> magnitude l) <span style=color:#ff79c6>+</span> (<span style=color:#bd93f9>2</span> <span style=color:#ff79c6>*</span> magnitude r)
</code></pre></td></tr></table>
</div>
</div><p>So I wrote a further function to convert from my element list, back to my tree:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>list2tree</span> <span style=color:#ff79c6>::</span> <span style=color:#8be9fd>String</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>ElemList</span> <span style=color:#ff79c6>-&gt;</span> <span style=color:#8be9fd>Elem</span>
<span style=color:#50fa7b>list2tree</span> p es <span style=color:#ff79c6>=</span> 
  maybe (<span style=color:#8be9fd>Pair</span> (list2tree (p <span style=color:#ff79c6>++</span> <span style=color:#f1fa8c>&#34;0&#34;</span>) es) 
              (list2tree (p <span style=color:#ff79c6>++</span> <span style=color:#f1fa8c>&#34;1&#34;</span>) es)) 
        <span style=color:#8be9fd>Lit</span> 
        (lookup p es)
</code></pre></td></tr></table>
</div>
</div><p>The <code>list2tree</code> function is:</p>
<ul>
<li>called with the empty string initially,</li>
<li>then it tries to lookup the value of that path</li>
<li>if that exists it is turned into a <code>Lit</code> node</li>
<li>if it does not exist, then we must be at a <code>Pair</code> node and</li>
<li>list2tree gets called recursively to fill in either branch</li>
</ul>
<h1 id=part-one>Part One</h1>
<p>Finally, I was able to find the magnitude of adding all the numbers together!</p>
<h1 id=part-two>Part Two</h1>
<p>For part two, we needed to find the highest magnitude when adding each pair of numbers together.
To get all the permutations of numbers I use a list comprehension:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-haskell data-lang=haskell><span style=color:#50fa7b>pairs</span> <span style=color:#ff79c6>=</span> [(x1, x2) <span style=color:#ff79c6>|</span> x1 <span style=color:#ff79c6>&lt;-</span> numbers, x2 <span style=color:#ff79c6>&lt;-</span> numbers, x1 <span style=color:#ff79c6>/=</span> x2]
</code></pre></td></tr></table>
</div>
</div><p>That worked by combining all the numbers and only picking out the ones where the first number is not equal to the
second. Note, this is working on my element list - as Haskell lists are automatically comparable. Neat!</p>
<p>Rest of the solution on <a href=https://github.com/beny23/advent-of-code/tree/main/2021/haskell/day18>GitHub</a></p>
<h1 id=conclusion>Conclusion</h1>
<p>This was a very interesting challenge as it demonstrated something I picked up a long time ago, if something does
not feel elegant, then there&rsquo;s a better solution somewhere. Call it intuition or experience, but it is often
very useful to keep tinkering if something is not as simple as it can be. Note also, I&rsquo;m sure there&rsquo;s lots of ways
this could still be simplified further, I just don&rsquo;t know Haskell well enough yet.</p>
<b>Tags</b>
<a href=https://beny23.github.io/tags/functional/>functional</a> <a href=https://beny23.github.io/tags/haskell/>haskell</a> <a href=https://beny23.github.io/tags/advent-of-code/>advent-of-code</a>
<p>
If you'd like to find more of my writing, why not follow me on
<a href=https://bsky.app/profile/beny23.github.io title="BlueSky link" rel=noopener aria-label="follow on BlueSky - Opens in a new window">Bluesky</a> or
<a href=https://infosec.exchange/@beny23 title="Mastodon link" rel=noopener aria-label="follow on Mastodon - Opens in a new window">Mastodon</a>?
</p>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Related</p>
<ul class="pa0 list">
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_17/>Advent of code 2021: Day 17</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_16/>Advent of code 2021: Day 16</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_15/>Advent of code 2021: Day 15</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_14/>Advent of code 2021: Day 14</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_13/>Advent of code 2021: Day 13</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_12/>Advent of code 2021: Day 12</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_11/>Advent of code 2021: Day 11</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_10/>Advent of code 2021: Day 10</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_9/>Advent of code 2021: Day 9</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_8/>Advent of code 2021: Day 8</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_7/>Advent of code 2021: Day 7</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_6/>Advent of code 2021: Day 6</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_5/>Advent of code 2021: Day 5</a>
</li>
<li class=mb2>
<a href=/posts/advent_of_code_2021_day_4/>Advent of code 2021: Day 4</a>
</li>
<li class=mb2>
<a href=/posts/fizzbuzz_without_ifs/>Fizzbuzz without if clauses</a>
</li>
</ul>
</div>
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://beny23.github.io/>
&copy; Software Design Systems 2024
</a>
<div>
<a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://twitter.com/giskard23 target=_blank class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://infosec.exchange/@beny23 target=_blank class="link-transition mastodon link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=noopener aria-label="follow on Mastodon——Opens in a new window"><svg height="32" style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</footer>
<script src=/dist/js/app.3fc0f988d21662902933.js></script>
</body>
</html>