<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>How I learned to stop worrying and love a vulnerability | Tales about Software Engineering</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.73.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet><meta property="og:title" content="How I learned to stop worrying and love a vulnerability"><meta property="og:description" content="Security specialists. Arghhh! They&rsquo;re all sitting in their &lsquo;ivory tower&rsquo; without anything better to do than to take a baseball bat to your hard work and tell you how you&rsquo;ve not considered some obscure vulnerability CVE-142341231/4234 in a library that you didn&rsquo;t even know existed. Not only that, there is definitely no way that you can deploy now, even when the product owner is breathing down your neck saying that nobody is going home until we&rsquo;ve fixed this!"><meta property="og:type" content="article"><meta property="og:url" content="https://beny23.github.io/posts/how_i_learned_to_stop_worrying_and_love_a_vulnerability/"><meta property="article:published_time" content="2018-07-02T10:22:14+01:00"><meta property="article:modified_time" content="2018-07-02T10:22:14+01:00"><meta itemprop=name content="How I learned to stop worrying and love a vulnerability"><meta itemprop=description content="Security specialists. Arghhh! They&rsquo;re all sitting in their &lsquo;ivory tower&rsquo; without anything better to do than to take a baseball bat to your hard work and tell you how you&rsquo;ve not considered some obscure vulnerability CVE-142341231/4234 in a library that you didn&rsquo;t even know existed. Not only that, there is definitely no way that you can deploy now, even when the product owner is breathing down your neck saying that nobody is going home until we&rsquo;ve fixed this!"><meta itemprop=datePublished content="2018-07-02T10:22:14+01:00"><meta itemprop=dateModified content="2018-07-02T10:22:14+01:00"><meta itemprop=wordCount content="1087"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="How I learned to stop worrying and love a vulnerability"><meta name=twitter:description content="Security specialists. Arghhh! They&rsquo;re all sitting in their &lsquo;ivory tower&rsquo; without anything better to do than to take a baseball bat to your hard work and tell you how you&rsquo;ve not considered some obscure vulnerability CVE-142341231/4234 in a library that you didn&rsquo;t even know existed. Not only that, there is definitely no way that you can deploy now, even when the product owner is breathing down your neck saying that nobody is going home until we&rsquo;ve fixed this!"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-171035600-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Tales about Software Engineering</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Blog page">Blog</a></li></ul><a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflowâ€”â€”Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17h-5.835v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedInâ€”â€”Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://beny23.github.io/posts/how_i_learned_to_stop_worrying_and_love_a_vulnerability/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://beny23.github.io/posts/how_i_learned_to_stop_worrying_and_love_a_vulnerability/&text=How%20I%20learned%20to%20stop%20worrying%20and%20love%20a%20vulnerability" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://beny23.github.io/posts/how_i_learned_to_stop_worrying_and_love_a_vulnerability/&title=How%20I%20learned%20to%20stop%20worrying%20and%20love%20a%20vulnerability" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">How I learned to stop worrying and love a vulnerability</h1><time class="f6 mv4 dib tracked" datetime=2018-07-02T10:22:14+01:00>July 2, 2018</time>
<span class="f6 mv4 dib tracked">- 6 minutes read</span>
<span class="f6 mv4 dib tracked">- 1087 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p><img src=/images/how_i_learned_to_stop_worrying_and_love_a_vulnerability_title.png alt></p><p>Security specialists. Arghhh! They&rsquo;re all sitting in their &lsquo;ivory tower&rsquo; without anything better to do than to take a
baseball bat to your hard work and tell you how you&rsquo;ve not considered some obscure vulnerability CVE-142341231/4234 in
a library that you didn&rsquo;t even know existed. Â Not only that, there is definitely no way that you can deploy now,
even when the product owner is breathing down your neck saying that nobody is going home until we&rsquo;ve fixed this!Â </p><p>No, I didn&rsquo;t think so either.Â Â </p><p>It isÂ reasonable to assume that they all have been inducted intoÂ a secret 5-year training programme coveredÂ by
government reporting restrictions. Â Either this, or at least spent a long time in Ops sitting in front of at least
7 monitors sipping cold strong coffee,Â learning the intricacies of the Linux firewall whilst also working to actively
block the l33t h4x0rzÂ attacking our website; while signed into all the servers simultaneously as root.</p><p>No, I didn&rsquo;t think so either! â€“ but come to think of it, this wouldÂ makeÂ for aÂ <em>good</em>Â cheesy film script!</p><p>So, exactly what does it take to get involved in security? Â The other day, I was sat around a table with a number of
security specialistsÂ (more on that later, but of that is a secret, ðŸ˜‰) and I was surprised whenÂ they all started
their introductions with &ldquo;I&rsquo;ve not had any formal security training&mldr;&rdquo; - it seems like they all sort of &lsquo;fell into it&rsquo;
so to speak, but come to think of it, so did I.</p><h1 id=debugging-puzzles>Debugging Puzzles</h1><p>My journey started as a developer and liking puzzles, in particular the ones that involved finding and fixingÂ production
issues that could not be reproduced locally and madeÂ no sense whatsoever.Â Â For example, why would the database think
that there is a working day between Friday and Sunday?Â </p><p>This is the code:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-sql data-lang=sql><span style=color:#6272a4>--Check if it is a Weekend - 6=Saturday , 7=Sunday._  
</span><span style=color:#6272a4></span><span style=color:#ff79c6>SELECT</span>Â to_char(pInputDate,<span style=color:#f1fa8c>&#39;D&#39;</span>)Â <span style=color:#ff79c6>INTO</span>Â vWeekend  
<span style=color:#ff79c6>FROM</span>Â DUAL;
</code></pre></td></tr></table></div></div><p>To determine the answer, you have to know that Oracle uses the Locale of the JDBC client to determine which &ldquo;Locale&rdquo; to
use in a DB session.Â  In this case,Â the container default of &ldquo;en_US&rdquo;Â meant that the first day of the week was Sunday.Â </p><p>But I digress&mldr; Â What does this have to do with security? Well, security holes are based on the similar puzzles.
Exploits are just bugs with unintended consequences.Â Â SQL injection, XML injection, XXE, XSRF are all down to
someone using a behaviour of code in a way that wasn&rsquo;t originally envisaged.Â Â </p><h1 id=working-backwards--whats-the-worst-that-could-happen>Working Backwards â€“ What&rsquo;s the worst that could happen?</h1><p>Quite a few months ago I realised that something wasn&rsquo;t quite right when looking at some of our teams inherited code.
Someone had commented out a Spring bean that did some encryption.Â  Most likely, it was commented out when debugging
locally and as it was too convoluted to set up encryption keys and keystores on the developer&rsquo;s laptop the change
was accidentally committed.</p><p>I know, we&rsquo;ve all made these kinds of mistakes.</p><p>However, rather than simply fixing, committing and then forgetting the issue, I thought, what is the worst that
could happen?Â  Is there any way I could exploit this?</p><p>To cut a long story short â€“ the keys were used to encrypt a Java Serialised Object which was POSTed between two
services via the user&rsquo;s browser.Â Â By not encrypting the object, it was possible to inject your own
Java Serialised Object and then have the server execute any command you like.</p><p>That&rsquo;s not good&mldr; It was exciting! I had just found my first proper &lsquo;in-the-wild&rsquo; real-life vulnerability!</p><p>Fortunately, I had already worked out what the fix was! All I did was find the root cause and worked backwards to
figure out what caused the problematic symptoms.Â  In my view, this isn&rsquo;t really that different to debugging.Â 
The same tools help (a debugger, a good network proxy) and a good bit of thinking outside the box, but of course,
that&rsquo;s all part and parcel of development, right?</p><h1 id=break-the-bank>Break the Bank</h1><p>My next steps into security were a stroke of good timing. As a member of the <a href=https://www.equalexperts.com/our-people/our-network/>Equal Experts network</a>,
I found out that they were running a 9-day event to let interested EE associates try to
<a href=https://www.equalexperts.com/blog/tech-focus/security-testing-how-we-tried-to-break-the-bank/>Break the Bank</a>!Â Â 
Armed with a version of the Xinja app (Australian aspiring neobank), <a href=https://www.charlesproxy.com>Charles Proxy</a>
and a good dose of &ldquo;malicious&rdquo; intent I managed to poke some dents into the backend.</p><p>It all got rather exciting when I thought I had caused the backend to stop responding!Â </p><h1 id=security-as-a-team-sport>Security as a Team Sport</h1><p>Wind the clock forward a couple of months, and my interest in security meant that I took on testing a newly migrated
reauthentication service for security holes.Â Â I <a href=https://beny23.github.io/posts/laughing_out_loud_malicious_auth/>had a laugh</a> and found
<a href=https://beny23.github.io/posts/hiding_xxe_in_spreadsheets/>XML can be dangerous</a>. I also learned that finding and fixing security
holes is only the part of the story.Â Â </p><p>My first step was to raise the issue with the security team.Â Â They then swung into action:</p><ul><li>Do the affected services need to be taken online?</li><li>How do we communicate with the business?</li><li>What else is affected?</li><li>How can we investigate whether the vulnerability has already been exploited?</li><li>How could the vulnerability be exploited?</li><li>How do we contact the service owners and/or people who can check for the same vulnerability?</li><li>How can we fix it?</li><li>How can we prevent it from happening again?</li></ul><p>Rather than the 7-monitored fast-typing caffeine freaks from the movie script above, the security team wielded
spreadsheets and Slack channels to: find the best people to investigate the issue across the estate, provide templates
on how to test, report any vulnerabilities and generally help out.Â  The three Cs of Communication, coordination and
context would be the key words to describe the flurry of activity taking place.</p><p>True enough, I ended up working long into Friday night and partway through Saturday morning to fix the issue but no
amount of frenzied hacking into my laptop would have been able to achieve anything without the 3 Cs and a lot of
valuable teamwork.</p><p>Now this was not only impressive and but exhilarating!</p><h1 id=postscript>Postscript</h1><p>I now find myself closely <a href=https://www.equalexperts.com/services/security/>liaising</a> with other Equal Experts security
professionals which provides a great opportunity to expand my skill set in a different and exciting direction.Â 
It doesn&rsquo;t mean that I&rsquo;m going to give up the day job though.Â  Without being a developer and debugging, I would not
have had the background knowledge to know what I could find when I start poking the system.</p><ul class=pa0></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://beny23.github.io/>&copy; Software Design Systems 2020</a><div><a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflowâ€”â€”Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17h-5.835v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a><a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedInâ€”â€”Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></span></a></div></div></footer><script src=/dist/js/app.3fc0f988d21662902933.js></script></body></html>