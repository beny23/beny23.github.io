<!doctype html><html lang=en-gb>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Make it so: GenAI, OpenAPI and ZAP | Tales about Software Engineering</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=ROBOTS content="INDEX, FOLLOW">
<link href=/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css rel=stylesheet>
<meta property="og:title" content="Make it so: GenAI, OpenAPI and ZAP">
<meta property="og:description" content="Have you ever wondered how hard it is to make an AI talk to an API? Wouldn&rsquo;t it be great if I could talk to a machine like Captain Picard does to his computer?
&ldquo;Tea. Earl Grey. Hot!&rdquo; would have to sent to the replicator subsystem with the correct instructions. But how would that actually work? I suppose, the Starship Enterprise-D made its first appearance on the airwaves in 1987. So at the time I guess we could expect a replicator to be programmed in C.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://beny23.github.io/posts/make_it_so_genai_and_zap/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2025-10-01T00:00:00+00:00">
<meta property="article:modified_time" content="2025-10-01T00:00:00+00:00">
<meta itemprop=name content="Make it so: GenAI, OpenAPI and ZAP">
<meta itemprop=description content="Have you ever wondered how hard it is to make an AI talk to an API? Wouldn&rsquo;t it be great if I could talk to a machine like Captain Picard does to his computer?
&ldquo;Tea. Earl Grey. Hot!&rdquo; would have to sent to the replicator subsystem with the correct instructions. But how would that actually work? I suppose, the Starship Enterprise-D made its first appearance on the airwaves in 1987. So at the time I guess we could expect a replicator to be programmed in C."><meta itemprop=datePublished content="2025-10-01T00:00:00+00:00">
<meta itemprop=dateModified content="2025-10-01T00:00:00+00:00">
<meta itemprop=wordCount content="1454">
<meta itemprop=keywords content="appsec,genai,openapi,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Make it so: GenAI, OpenAPI and ZAP">
<meta name=twitter:description content="Have you ever wondered how hard it is to make an AI talk to an API? Wouldn&rsquo;t it be great if I could talk to a machine like Captain Picard does to his computer?
&ldquo;Tea. Earl Grey. Hot!&rdquo; would have to sent to the replicator subsystem with the correct instructions. But how would that actually work? I suppose, the Starship Enterprise-D made its first appearance on the airwaves in 1987. So at the time I guess we could expect a replicator to be programmed in C.">
<link rel=me href=https://infosec.exchange/@beny23>
<script data-goatcounter=https://beny23.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
</head>
<body class="ma0 avenir bg-near-white production">
<header class="cover bg-top" style=background-image:url(https://beny23.github.io/images/make_it_so_genai_and_zap_title.png)>
<div class="pb3-m pb6-l bg-black-60">
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
Tales about Software Engineering
</a>
<div class="flex-l items-center">
<ul class="pl0 mr3">
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/about/ title="About page">
About
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/posts/ title="Blog page">
Blog
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/talks/ title="Talks page">
Talks
</a>
</li>
<li class="list f5 f4-ns fw4 dib pr3">
<a class="hover-white no-underline white-90" href=/tags/ title="Tags page">
Tags
</a>
</li>
</ul>
<a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://infosec.exchange/@beny23 target=_blank class="link-transition mastodon link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=noopener aria-label="follow on Mastodon——Opens in a new window"><svg height="32" style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</nav>
<div class="tc-l pv6 ph3 ph4-ns">
<h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Make it so: GenAI, OpenAPI and ZAP</h1>
</div>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class=mt3>
<a href="https://www.facebook.com/sharer.php?u=https://beny23.github.io/posts/make_it_so_genai_and_zap/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg>
</a>
<a href="https://twitter.com/share?url=https://beny23.github.io/posts/make_it_so_genai_and_zap/&text=Make%20it%20so:%20GenAI,%20OpenAPI%20and%20ZAP" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=https://beny23.github.io/posts/make_it_so_genai_and_zap/&title=Make%20it%20so:%20GenAI,%20OpenAPI%20and%20ZAP" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</a>
</div>
<h1 class="f1 athelas mt3 mb1">Make it so: GenAI, OpenAPI and ZAP</h1>
<time class="f6 mv4 dib tracked" datetime=2025-10-01T00:00:00Z>October 1, 2025</time>
<span class="f6 mv4 dib tracked"> - 7 minutes read</span>
<span class="f6 mv4 dib tracked"> - 1454 words</span>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Have you ever wondered how hard it is to make an AI talk to an API? Wouldn&rsquo;t it
be great if I could talk to a machine like Captain Picard does to his computer?</p>
<p><img src=/images/make_it_so_genai_and_zap_picard.png alt="Tea. Early Grey. Hot"></p>
<p>&ldquo;Tea. Earl Grey. Hot!&rdquo; would have to sent to the replicator subsystem with the correct instructions. But how would that
actually work? I suppose, the Starship Enterprise-D made its first appearance on the airwaves in 1987. So at the time
I guess we could expect a replicator to be programmed in C. Though to be fair as a vessel with military capacity,
probably Ada. And probably a monolith. So we probably would have to expect the replicator software to have a voice
recognition subsystem.</p>
<p>But we&rsquo;re not in the 80s anymore, we&rsquo;ve got modern software. We&rsquo;ve got APIs and we&rsquo;ve got GenAI. So what would a modern
replicator architecture look like? Like on the Enterprise G (first aired 2023).</p>
<p><img src=/images/make_it_so_genai_and_zap_enterprise_g.png alt="USS Enterprise G"></p>
<p>First of all, I think we&rsquo;d probably write it in Rust or Go, or maybe Typescript. There&rsquo;s bound to be a kubernetes
cluster somewhere. And there&rsquo;s going to be APIs!</p>
<p><img src=/images/make_it_so_genai_and_zap_apis.png alt=APIs></p>
<p>We&rsquo;d probably decompose the voice subsystem into its own. Then we&rsquo;d have a something that translates the
voice command into actual commands. And these days that&rsquo;s obviously going to be an LLM.</p>
<h1 id=make-it-so>Make it So</h1>
<p>As I&rsquo;ve got an AppSec hat, I what could I use to demonstrate this idea? Why not <a href=https://www.zaproxy.org>ZAP</a>.
After all, the ZAP UI feels a little bit on the dated side:</p>
<p><img src=/images/make_it_so_genai_and_zap_ui.png alt="ZAP UI"></p>
<p>Luckily ZAP has got an API. The default interface is&mldr; erm, how do I say this without throwing shade&mldr; let&rsquo;s just leave
this here:</p>
<p><img src=/images/make_it_so_genai_and_zap_api_ui.png alt="API UI"></p>
<h1 id=just-use-ai>Just use AI</h1>
<p>In order for LLMs to talk to tools, one way of doing that is using the <a href=https://modelcontextprotocol.io/>Model Context Protocol (MCP)</a>.
Here&rsquo;s a crude drawing of how it works:</p>
<p><img src=/images/make_it_so_genai_and_zap_mcp.png alt=MCP></p>
<p>The LLM orchestrator - also known as the MCP client - is responsible for telling the LLM about the available tools
and when the model lets the orchestrator know to call the tools, it will invoke them based on the Model
Context Protocol.</p>
<p>That&rsquo;s the theory anyway. So I searched google for a ZAP MCP. And sure enough there was one. But did I want to use
that?</p>
<p><img src=/images/make_it_so_genai_and_zap_sure_grandma.png alt="Sure grandma"></p>
<p>I know some of the young kids these days will enable <a href=https://github.com/anthropics/claude-code/issues/2564>dangerous mode</a>
or <a href=https://forum.cursor.com/t/yolo-mode-is-amazing/36262>yolo mode</a>, but I think random MCP servers are quite a
risk at the moment. There&rsquo;s this rush toward AI and as per usual security is an afterthought.</p>
<p>My go-to rules for using MCP servers at the moment are:</p>
<ul>
<li>is it an official one?</li>
<li>have you built it yourself?</li>
<li>can you isolate it (e.g. run it in a docker container without access to your machine)</li>
</ul>
<p>I&rsquo;m not feeling comfortable downloading Dave from Kentucky&rsquo;s MCP server for accessing my emails. Especially
as email access was just <a href=https://www.koi.security/blog/postmark-mcp-npm-malicious-backdoor-email-theft>trivially exploited</a>.</p>
<p>Luckily, there&rsquo;s quite a mature ecosystem around APIs. With <a href=https://www.openapis.org/blog/2017/07/26/the-oai-announces-the-openapi-specification-3-0-0>OpenAPI Specifications</a>
there&rsquo;s a powerful way of expressing APIs and lots of tooling to build.</p>
<h1 id=how-hard-can-it-be>How hard can it be?</h1>
<p>ZAP has an <a href=https://raw.githubusercontent.com/zaproxy/zap-api-docs/main/openapi.yaml>OpenAPI spec</a>, so it should
be quite easy to create an MCP. I mean there&rsquo;s so many MCPs out there, even a GenAI code generator should be able
to do this.</p>
<p>But then I thought&mldr;</p>
<p><img src=/images/make_it_so_genai_and_zap_vibecode_drake.png alt="Vibecode Drake"></p>
<p>So I did. Some thoughts on vibecoding:</p>
<h2 id=complexity>Complexity</h2>
<p>The machine wants everything to be complex, it starts out with automatic retries, circuit breakers. This
is the wrong way round! We should start simple and then make it more complex later on. When I start, I don&rsquo;t
even know whether retries will be needed!</p>
<h2 id=libraries-what-libraries>Libraries, what libraries?</h2>
<p>The machine has blinkers on. When I asked it to code an MCP, it went straight for implementing the protocol from
scratch. I think this is one of the fundamental flaws with vibecoding at the moment. Sure, it might work, but
it won&rsquo;t be easy to maintain.</p>
<h2 id=youre-absolutely-right>You&rsquo;re absolutely right!</h2>
<p>So when I suggested to make our lives easier by using <a href=https://gofastmcp.com/integrations/openapi>FastMCP&rsquo;s OpenAPI integration</a>
it was all for it. I detest the sycophantic way it keeps telling me that I asked a great question, or made a good
point.</p>
<p>Of course, even after I restarted the whole process from scratch and added &ldquo;please use that library&rdquo; to the prompt,
it then proceeded to implement automatic retries again. Argh! We don&rsquo;t need that!</p>
<p>You&rsquo;re absolutely right&mldr;</p>
<h2 id=is-it-faster>Is it faster?</h2>
<p>If you want to check out my OpenAPI MCP server, it&rsquo;s available here: <a href=https://github.com/beny23/openapi-mcp-server>https://github.com/beny23/openapi-mcp-server</a>.
You can see <a href=https://github.com/beny23/openapi-mcp-server/tree/main/prompts>how I&rsquo;ve prompted</a> the machine to
generate prompts for it to then follow in an effort to keep it from losing track. Which was moderately successful.</p>
<p>All in all I found the experience frustrating because I can&rsquo;t shake the feeling that I would have been a lot
quicker if I had just read the FastMCP documentation myself and implemented it. There certainly would have been some
tests!!!</p>
<h1 id=lets-run-it>Let&rsquo;s Run it</h1>
<p>So to put it all together, I&rsquo;ve chosen to run my MCP servers in docker containers.</p>
<h2 id=zap>ZAP</h2>
<pre tabindex=0><code>$ docker run --rm \
    --name zap-proxy \ 
    --network=mcp \
    -p 8081:8081 \
    ghcr.io/zaproxy/zaproxy:stable zap.sh \ 
    -daemon \
    -host 0.0.0.0 \
    -port 8081 \
    -config &quot;api.key=your-secret-api-key-here&quot; \ 
    -config &quot;api.addrs.addr.name=.*&quot; \
    -config &quot;api.addrs.addr.regex=true&quot; \ 
    -Xmx6g
</code></pre><p>Let&rsquo;s unpack what is happening here:</p>
<ul>
<li>We&rsquo;re running a ZAP proxy docker image</li>
<li><code>-Xmx6g</code>: we increase the memory to ensure ZAP doesn&rsquo;t die when doing more than a few scans</li>
<li><code>-p 8081:8081</code>: we&rsquo;re exposing the API and proxy port</li>
<li><code>--network=mcp</code>: we&rsquo;re putting it on a docker network - our MCP server will run in a separate container</li>
<li><code>api.address.addr.*</code>: by default ZAP only listens on the local interface, with these options we&rsquo;re telling
ZAP it is ok to listen on all interfaces (but they&rsquo;re restricted by docker anyway)</li>
<li><code>api.key</code>: sets an API key - this doesn&rsquo;t need to be particularly secure as we&rsquo;re only playing with this locally</li>
</ul>
<h2 id=mcp-server>MCP Server</h2>
<pre tabindex=0><code>$ docker run --rm \
    -p 8000:8000 \
    --network=mcp \
    openapi-mcp-server \ 
    https://raw.githubusercontent.com/zaproxy/zap-api-docs/main/openapi.yaml \ 
    --host 0.0.0.0 \
    --port 8000 \
    --base-url http://zap-proxy:8081 \ 
    --header &quot;X-ZAP-API-Key: your-secret-api-key-here&quot; \ 
    --include-paths '^/JSON/(spider|ajaxSpider|ascan|pscan|alert|reports|context|users|wappalyzer)/(action|view)/(scan|scanAsUser|results|fullResults|allUrls|scans|progress|enableAllScanners|disableAllScanners|scanners|alerts|numberOfAlerts|alertsSummary|alertCountsByRisk|alertsByRisk|generateReport|newContext|includeInContext|excludeFromContext|newUser|usersList|getAuthenticationSession|setAuthenticationCredentials|setUserEnabled|setUserName|listSite|listAll)' \
    --exclude-paths '.*' \
    --server-type http
</code></pre><p>So here we are using my noddy <a href=https://github.com/beny23/openapi-mcp-server>openapi-mcp-server</a>:</p>
<ul>
<li>We pass it the URL of the <a href=https://raw.githubusercontent.com/zaproxy/zap-api-docs/main/openapi.yaml>ZAP OpenAPI spec</a></li>
<li>We configure the <code>X-ZAP-API-Key</code> header to be passed along - that&rsquo;s the same value as the API key defined above</li>
<li>We set the <code>base-url</code> to the name of the ZAP container</li>
<li>And we&rsquo;re setting some include paths. This is a way of restricting the number of tools that are exposed.
ZAP exposes about 900 different endpoints, we don&rsquo;t want to overwhelm the LLM with available tools. For context,
when I first wrote this Cursor struggled to deal with more than 40 tools.</li>
</ul>
<h1 id=ready-to-engage>Ready to engage</h1>
<p>So now, we&rsquo;ve set up ZAP, and are exposing the API as an MCP server. All that remains is to hook it into our
LLM.</p>
<p>To use it with Claude or Cursor, it&rsquo;s just a manner of adding it in the requisite config file:</p>
<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json>{
  <span style=color:#ff79c6>&#34;mcpServers&#34;</span>: {
    <span style=color:#ff79c6>&#34;zap&#34;</span>: {
      <span style=color:#ff79c6>&#34;type&#34;</span>: <span style=color:#f1fa8c>&#34;http&#34;</span>,
      <span style=color:#ff79c6>&#34;url&#34;</span>: <span style=color:#f1fa8c>&#34;http://localhost:8000/mcp&#34;</span>
    }
  }
}
</code></pre></td></tr></table>
</div>
</div><p>And then you can use it with Cursor</p>
<p><img src=/images/make_it_so_genai_and_zap_cursor_calling.png alt="Cursor calling ZAP"></p>
<p>and it will control ZAP for you</p>
<p><img src=/images/make_it_so_genai_and_zap_cursor_calling_tool.png alt="Cursor calling ZAP tool details"></p>
<h1 id=you-said-talking-to-it>You said Talking to It</h1>
<p>Well, if you literally want to do that, I just use Apple Dictation:</p>
<p><img src=/images/make_it_so_genai_and_zap_apple_dictation.png alt="Apple Dictation"></p>
<p>then you can just talk. In this example, I&rsquo;m talking to Claude:</p>
<p><img src=/images/make_it_so_genai_and_zap_talk_to_claude.png alt="Talk to Claude"></p>
<p>Under the hood, this uses the OS feature to translate my voice into text. That text is then sent to the LLM
augmented with the list of tools it can call. Then the LLM picks which MCP tool to call, which then calls ZAP.</p>
<p>Now we just need a replicator!</p>
<h1 id=made-it-so>Made It So?</h1>
<p>In closing, a few reflections: This is a great gimmick. It certainly plays well in demos. And it&rsquo;s a bit of fun.
But are MCPs the right choice? I&rsquo;m not so sure. A big problem is the context window. When the tools reply, they
tend to reply in JSON. And then the LLM has to interpret that. Particularly with large responses that then gets
to be quite tricky for the LLM.</p>
<p>A fair few times, the ZAP tool would output a lot of JSON, and the LLM would struggle with interpreting that.
I also used the same setup to drive Shodan (which has an API) but it kept returning so much detail, that it was
quite difficult to get the right information out of it.</p>
<p>Possibly a way around this is instead of using MCP tooling, have the LLM write python or shell scripts itself. And
then have it execute those scripts. Kind of like I would myself. If there&rsquo;s too much data, I use bash command
lines to interrogate it.</p>
<p>I guess I&rsquo;ll be writing a follow-up post. Hope you enjoyed this.</p>
<b>Tags</b>
<a href=https://beny23.github.io/tags/appsec/>appsec</a> <a href=https://beny23.github.io/tags/genai/>genai</a> <a href=https://beny23.github.io/tags/openapi/>openapi</a>
<p>
If you'd like to find more of my writing, why not follow me on
<a href=https://bsky.app/profile/beny23.github.io title="BlueSky link" rel=noopener aria-label="follow on BlueSky - Opens in a new window">Bluesky</a> or
<a href=https://infosec.exchange/@beny23 title="Mastodon link" rel=noopener aria-label="follow on Mastodon - Opens in a new window">Mastodon</a>?
</p>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Related</p>
<ul class="pa0 list">
<li class=mb2>
<a href=/posts/bsides_ncl_2025/>BSides Newcastle 2025: Mission to Cyberspace</a>
</li>
<li class=mb2>
<a href=/posts/cyber_manchester_2024/>Cyber Measures Up in Manchester</a>
</li>
<li class=mb2>
<a href=/posts/my_take_on_compliance_in_modern_dev/>Resisting compliance is futile</a>
</li>
<li class=mb2>
<a href=/posts/appsec_loves_agile/>AppSec loves Agile</a>
</li>
<li class=mb2>
<a href=/posts/bsides_ncl_2023/>BSides Newcastle 2023: Chaos for the future</a>
</li>
<li class=mb2>
<a href=/posts/automatic_dependency_updates/>The Case Against Automatic Dependency Updates</a>
</li>
<li class=mb2>
<a href=/posts/harvesting_logs_for_fun_and_profit/>Harvesting Logs for Fun and Profit</a>
</li>
<li class=mb2>
<a href=/posts/why_appsec_fails/>Why AppSec fails</a>
</li>
<li class=mb2>
<a href=/posts/precision_munitions_for_denial_of_service/>Precision Munitions for Denial of Service</a>
</li>
<li class=mb2>
<a href=/posts/curating_vulnerabilities/>Curating Dependency Vulnerabilities</a>
</li>
</ul>
</div>
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://beny23.github.io/>
&copy; Software Design Systems 2025
</a>
<div>
<a href=https://stackoverflow.com/users/227140/beny23 target=_blank class="link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><svg height="32" style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://www.linkedin.com/in/gerald-benischke-9811b663 target=_blank class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://github.com/beny23 target=_blank class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel=noopener aria-label="follow on Github——Opens in a new window"><svg height="32" style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
<a href=https://infosec.exchange/@beny23 target=_blank class="link-transition mastodon link dib z-999 pt3 pt0-l mr1" title="Mastodon link" rel=noopener aria-label="follow on Mastodon——Opens in a new window"><svg height="32" style="enable-background:new 0 0 230 230" viewBox="0 0 230 230" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M211.80683 139.0875c-3.1825 16.36625-28.4925 34.2775-57.5625 37.74875-15.16 1.80875-30.0825 3.47125-45.99875 2.74125-26.0275-1.1925-46.565-6.2125-46.565-6.2125.0 2.53375.15625 4.94625.46875 7.2025 3.38375 25.68625 25.47 27.225 46.3925 27.9425 21.115.7225 39.91625-5.20625 39.91625-5.20625l.86875 19.09s-14.77 7.93125-41.08125 9.39c-14.50875.7975-32.52375-.365-53.50625-5.91875C9.23183 213.82 1.40558 165.31125.20808 116.09125c-.36375-14.61375-.14-28.39375-.14-39.91875.0-50.33 32.97625-65.0825 32.97625-65.0825C49.67058 3.45375 78.20308.2425 107.86433.0h.72875c29.66125.2425 58.21125 3.45375 74.8375 11.09.0.0 32.97625 14.7525 32.97625 65.0825.0.0.4125 37.13375-4.6 62.915" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/><path d="M65.68743 96.45938c0 9.01375-7.3075 16.32125-16.3225 16.32125-9.01375.0-16.32-7.3075-16.32-16.32125.0-9.01375 7.30625-16.3225 16.32-16.3225 9.015.0 16.3225 7.30875 16.3225 16.3225M124.52893 96.45938c0 9.01375-7.30875 16.32125-16.3225 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225 9.01375.0 16.3225 7.30875 16.3225 16.3225M183.36933 96.45938c0 9.01375-7.3075 16.32125-16.32125 16.32125s-16.32125-7.3075-16.32125-16.32125c0-9.01375 7.3075-16.3225 16.32125-16.3225s16.32125 7.30875 16.32125 16.3225" fill="#fff"/></svg>
<span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" width="8" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg>
</span></a>
</div>
</div>
</footer>
<script src=/dist/js/app.3fc0f988d21662902933.js></script>
</body>
</html>